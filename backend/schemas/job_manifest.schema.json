{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://hexforgelabs.com/schemas/job_manifest.schema.json",
  "title": "HexForge Job Manifest (v1)",
  "type": "object",
  "required": ["version", "job_id", "service", "updated_at", "public_root", "public"],
  "properties": {
    "version": {
      "type": "string",
      "enum": ["v1"],
      "description": "Manifest contract version."
    },
    "job_id": {
      "type": "string",
      "minLength": 3,
      "description": "Stable job identifier (filesystem-safe)."
    },
    "service": {
      "type": "string",
      "minLength": 2,
      "description": "Engine/service name (e.g., hexforge-glyphengine)."
    },
    "updated_at": {
      "type": "string",
      "format": "date-time",
      "description": "ISO8601 timestamp for last update."
    },
    "subfolder": {
      "type": ["string", "null"],
      "pattern": "^[A-Za-z0-9_-]+$",
      "description": "Optional sanitized subfolder used in public paths."
    },
    "public_root": {
      "type": "string",
      "pattern": "^/assets/",
      "description": "Root folder for all public assets for this job."
    },
    "public": {
      "type": "object",
      "description": "Public asset references (relative URLs).",
      "required": ["job_json", "enclosure", "textures", "previews"],
      "properties": {
        "job_json": { "type": "string", "pattern": "^/assets/" },

        "enclosure": {
          "type": "object",
          "required": ["stl"],
          "properties": {
            "stl": { "type": "string", "pattern": "^/assets/" },
            "obj": { "type": "string", "pattern": "^/assets/" },
            "glb": { "type": "string", "pattern": "^/assets/" }
          },
          "additionalProperties": false
        },

        "textures": {
          "type": "object",
          "required": ["texture_png", "heightmap_png"],
          "properties": {
            "texture_png": { "type": "string", "pattern": "^/assets/" },
            "heightmap_png": { "type": "string", "pattern": "^/assets/" },
            "heightmap_exr": { "type": "string", "pattern": "^/assets/" }
          },
          "additionalProperties": false
        },

        "previews": {
          "type": "object",
          "required": ["hero", "iso", "top", "side"],
          "properties": {
            "hero": { "type": "string", "pattern": "^/assets/" },
            "iso": { "type": "string", "pattern": "^/assets/" },
            "top": { "type": "string", "pattern": "^/assets/" },
            "side": { "type": "string", "pattern": "^/assets/" }
          },
          "additionalProperties": false
        }
      },
      "additionalProperties": false
    }
  },
  "additionalProperties": false
}
